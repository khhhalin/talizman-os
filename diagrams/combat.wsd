@startuml combat
title Combat System

!include diagram.enums.wsd
hide enum

class CombatManager <<Node>> {
  - bool is_psychic_combat
  - Player attacker
  - EnemyCard defender
  + initiate_combat(attacker: Player, defender: EnemyCard, is_psychic: bool)
  + resolve_combat(): CombatResult
  + calculate_combat_score(player: Player): int
  --signals--
  + combat_started(attacker: Player, defender: EnemyCard)
  + combat_resolved(result: CombatResult)
}

class CombatResult <<Resource>> {
  - bool player_won
  - int damage_dealt
  - Array<String> consequences
  - Dictionary rewards
}

class EnemyCard
class Player <<CharacterBody2D>>
class DiceRoller <<Node>> {
  + roll_die(): int
  + roll_multiple(count: int): Array<int>
}
class CombatUI <<Control>>
abstract class StandardCard <<Resource>>

EnemyCard --|> StandardCard

CombatManager --> DiceRoller : uses
CombatManager --> Player : involves
CombatManager --> EnemyCard : involves
CombatManager --> CombatResult : produces
CombatUI --> CombatManager : displays state

@enduml